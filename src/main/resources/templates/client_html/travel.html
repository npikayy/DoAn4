<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tôi Đi Du Lịch</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/vn.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        .recommended-tours-carousel {
            padding: 20px 0;
        }
        .swiper-slide {
            height: auto;
            padding: 0 10px;
        }
        .swiper-button-next, .swiper-button-prev {
            color: #3B82F6;
            background: rgba(255, 255, 255, 0.8);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 20px;
            font-weight: bold;
        }
        .swiper-pagination-bullet-active {
            background: #3B82F6;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        .hero-banner {
            background-size: cover;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.3))
            ,url("/img/banner.jpg") no-repeat center;
        }

        .quick-link-card {
            transition: all 0.3s ease;
        }
        .quick-link-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .destination-tab {
            transition: all 0.2s ease;
        }
        .destination-tab.active {
            border-bottom: 3px solid #1d4ed8;
            color: #1d4ed8;
            font-weight: 600;
        }

        .destination-card {
            position: relative;
            overflow: hidden;
            border-radius: 0.5rem;
            height: 180px;
        }
        .destination-card img {
            transition: transform 0.5s ease;
        }
        .destination-card:hover img {
            transform: scale(1.05);
        }
        .destination-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
        }
        .carousel-slide {
            transition: opacity 1s ease-in-out;
        }
        .carousel-slide:not(.active) {
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
<header th:replace="client_html/fragment/headerANDfooter :: header"></header>

<!-- Luxury Travel Hero Section -->
<section class="luxury-hero relative">
    <!-- Background with gradient overlay -->
    <div class="absolute inset-0 bg-gradient-to-r from-indigo-900/80 to-teal-800/80 z-0"></div>
    <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80')] bg-cover bg-center z-[-1]"></div>

    <div class="container mx-auto px-4 py-24 md:py-32 relative z-10">
        <!-- Tagline with animated text -->
        <div class="mb-8 text-center">
      <span class="inline-block bg-white/20 backdrop-blur-sm text-white px-4 py-1 rounded-full text-sm font-medium mb-4 animate-pulse">
        ✦ MÙA DU LỊCH 2025 ✦
      </span>
            <h1 class="text-4xl md:text-6xl font-bold text-white mb-4 leading-tight">
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-amber-300 to-teal-300">Khám Phá Thế Giới</span><br>
                Theo Cách Của Riêng Bạn
            </h1>
            <p class="text-xl text-white/90 max-w-2xl mx-auto">
                Trải nghiệm dịch vụ đẳng cấp với những ưu đãi đặc biệt chỉ có trong mùa hè này
            </p>
        </div>

        <!-- Interactive Search Panel -->
        <div th:replace="client_html/fragment/search_panel :: search_panel"></div>
    </div>
</section>

<!-- Interactive Carousel Banner -->
<section class="py-10 relative">
    <!-- Background wave effect -->
    <div class="absolute inset-x-0 bottom-0 h-24 bg-gradient-to-t from-white to-transparent z-20"></div>

    <div class="container mx-auto px-4">
        <div class="relative h-[500px] overflow-hidden rounded-2xl shadow-2xl group">
            <!-- Slides Container -->
            <div class="relative h-full" id="carousel-slides">
                <!-- Dynamic Slides -->
                <div th:each="banner, iter : ${banners}"
                     th:if="${banner.is_showed}"
                     th:classappend="${iter.index == 0} ? 'active opacity-100' : 'opacity-0'"
                     class="carousel-slide h-full w-full flex items-center justify-center bg-cover bg-center absolute inset-0 transition-all duration-1000 ease-[cubic-bezier(0.65,0.05,0.36,1)]"
                     th:style="'background-image: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url(' + ${banner.banner_url} + ')'">

                    <div class="text-center text-white px-6 transform transition-all duration-700 ease-out group-hover:scale-105">
                        <h2 class="text-5xl font-bold mb-6 drop-shadow-2xl">TOUR ƯU ĐÃI 2024</h2>
                        <p class="text-2xl mb-8 max-w-2xl mx-auto drop-shadow-lg">Khám phá những điểm đến tuyệt vời</p>
                    </div>
                </div>

                <!-- Default Slide -->
                <div th:if="${#lists.isEmpty(banners.?[is_showed == true])}"
                     class="carousel-slide active h-full w-full flex items-center justify-center bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500">
                    <div class="text-center text-white px-6 transform transition-all duration-700 ease-out group-hover:scale-105">
                        <h2 class="text-5xl font-bold mb-6 drop-shadow-2xl">TOUR ƯU ĐÃI 2024</h2>
                        <p class="text-2xl mb-8 max-w-2xl mx-auto drop-shadow-lg">Khám phá những điểm đến tuyệt vời</p>
                    </div>
                </div>
            </div>

            <!-- Navigation Arrows (Floating) -->
            <button th:if="${#lists.size(banners.?[is_showed == true]) > 1}"
                    class="absolute left-6 top-1/2 -translate-y-1/2 bg-white/10 hover:bg-white/30 text-white rounded-full p-3 z-10 transition-all backdrop-blur-sm border border-white/20 hover:scale-110 shadow-lg"
                    id="prevBtn">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                </svg>
            </button>
            <button th:if="${#lists.size(banners.?[is_showed == true]) > 1}"
                    class="absolute right-6 top-1/2 -translate-y-1/2 bg-white/10 hover:bg-white/30 text-white rounded-full p-3 z-10 transition-all backdrop-blur-sm border border-white/20 hover:scale-110 shadow-lg"
                    id="nextBtn">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                </svg>
            </button>

            <!-- Modern Indicators -->
            <div th:if="${#lists.size(banners.?[is_showed == true]) > 1}"
                 class="absolute bottom-8 left-0 right-0 flex justify-center gap-3 z-10">
                <button th:each="banner, iter : ${banners}"
                        th:if="${banner.is_showed}"
                        class="w-16 h-1.5 rounded-full bg-white/30 hover:bg-white/70 indicator-dot transition-all duration-300 overflow-hidden"
                        th:classappend="${iter.index == 0} ? 'active' : ''"
                        th:attr="data-slide=${iter.index}">
                    <div class="h-full bg-white origin-left scale-x-0 transition-transform duration-300 ease-out indicator-progress"></div>
                </button>
            </div>
        </div>
    </div>
</section>

<!-- Promotion Banners Section -->
<section class="py-12 bg-white" th:if="${promotionBanners != null and !promotionBanners.isEmpty()}">
    <div class="container-fluid mx-auto px-4">
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3">ƯU ĐÃI HẤP DẪN</h2>
            <div class="w-20 h-1 bg-red-600 mx-auto mb-4"></div>
            <p class="text-gray-600 max-w-2xl mx-auto text-lg">Đừng bỏ lỡ những chương trình khuyến mãi đặc biệt chỉ có tại Tôi Đi Du Lịch!</p>
        </div>

        <div class="swiper-container promotion-banners-carousel">
            <div class="swiper-wrapper">
                <!-- Promotion Banner Slide -->
                <div th:each="promo : ${promotionBanners}" class="swiper-slide h-full pb-4">
                    <a th:href="@{'/Client/khuyen-mai/' + ${promo.id}}" class="block relative w-full h-80 rounded-xl overflow-hidden group">
                        <img th:src="${promo.hinhAnh != null && !promo.hinhAnh.isEmpty() ? promo.hinhAnh : '/img/default-tour.jpg'}" alt="Promotion Image" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"/>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>
                        
                        <div class="relative h-full flex flex-col justify-end p-6 text-white">
                            <div class="absolute top-4 left-4 px-3 py-1 rounded-full text-sm font-semibold text-white"
                                 th:classappend="${#dates.createNow().after(promo.ngayKetThuc)} ? 'bg-red-500' : (${#dates.createNow().before(promo.ngayBatDau)} ? 'bg-yellow-500' : 'bg-green-500')"
                                 th:text="${#dates.createNow().after(promo.ngayKetThuc)} ? 'Đã kết thúc' : (${#dates.createNow().before(promo.ngayBatDau)} ? 'Sắp diễn ra' : 'Đang hoạt động')">
                            </div>
                            <div class="absolute top-4 right-4 bg-gradient-to-r from-red-500 to-orange-500 text-white font-bold text-sm px-3 py-1 rounded-full shadow-lg">
                                <i class="fas fa-tags mr-1"></i>
                                <span th:text="'GIẢM ' + ${promo.phanTramGiamGia} + '%'"></span>
                            </div>
                            <h3 class="text-2xl font-bold mb-2" th:text="${promo.tenKhuyenMai}"></h3>
<!--                            <p class="text-base mb-4" th:text="${promo.moTa}"></p>-->
                            
                            <div class="text-xs opacity-80">
                                <i class="fas fa-calendar-check mr-1"></i>
                                <span>Áp dụng từ <strong th:text="${#dates.format(promo.ngayBatDau, 'dd/MM')}"></strong> đến <strong th:text="${#dates.format(promo.ngayKetThuc, 'dd/MM/yyyy')}"></strong></span>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <!-- Add Pagination -->
            <div class="swiper-pagination"></div>
        </div>
    </div>
</section>

<section class="py-12 bg-gray-50">
    <div class="container overflow-hidden mx-auto px-4">
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3">TOUR GỢI Ý CHO BẠN</h2>
            <div class="w-20 h-1 bg-blue-600 mx-auto mb-4"></div>
            <p class="text-gray-600 max-w-2xl mx-auto text-lg">Những hành trình phù hợp với sở thích của bạn</p>
        </div>

        <!-- Carousel Container -->
        <div class="relative">
            <!-- Carousel Slides -->
            <div class="swiper-container recommended-tours-carousel">
                <div class="swiper-wrapper">
                    <!-- Tour Card - Mỗi slide chứa 1 tour -->
                    <div th:each="tour : ${recommendedTours}" class="swiper-slide">
                        <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 group h-full"
                             th:attr="data-name=${tour.tour_name.toLowerCase()},
                                      data-type=${tour.tour_type},
                                      data-price=${tour.discount_promotion != null ? tour.tour_adult_price * (100 - tour.discount_promotion.phanTramGiamGia) / 100 : tour.tour_adult_price}">
                            <a th:href="@{'/Client/TourDetail/' + ${tour.tour_id}}" class="block h-full flex flex-col">
                                <!-- Tour Image -->
                                <div class="relative h-56 overflow-hidden">
                                    <img th:if="${RecommendedTourThumbnails.get(tour.tour_id) != null and !RecommendedTourThumbnails.get(tour.tour_id).isEmpty()}"
                                         th:src="${RecommendedTourThumbnails.get(tour.tour_id)}"
                                         alt="Tour image"
                                         class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                                    <img th:unless="${RecommendedTourThumbnails.get(tour.tour_id) != null and !RecommendedTourThumbnails.get(tour.tour_id).isEmpty()}"
                                         src="/img/default-tour.jpg"
                                         alt="Default tour image"
                                         class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">

                                    <!-- Duration Badge -->
                                    <div class="absolute top-4 left-4 bg-white/90 text-gray-800 px-3 py-1 rounded-full text-sm font-semibold shadow-sm">
                                        <i class="fas fa-clock mr-1 text-blue-600"></i>
                                        <span th:text="${tour.tour_duration} + ' ngày'"></span>
                                    </div>

                                    <!-- Discount Ribbon -->
                                    <div th:if="${tour.discount_promotion != null && #dates.createNow().after(tour.discount_promotion.ngayBatDau) && #dates.createNow().before(tour.discount_promotion.ngayKetThuc)}"
                                         class="absolute top-0 right-0 bg-red-600 text-white px-3 py-2 font-bold transform rotate-45 translate-x-8 -translate-y-2 w-32 text-center">
                                        <span th:text="'Giảm ' + ${tour.discount_promotion.phanTramGiamGia} + '%'"></span>
                                    </div>
                                </div>

                                <!-- Tour Info -->
                                <div class="p-5 flex-grow flex flex-col">
                                    <!-- Tour Name -->
                                    <h3 class="text-xl font-bold text-gray-800 mb-3 group-hover:text-blue-600 transition-colors" th:text="${tour.tour_name}"></h3>
                                    <!-- Rating -->
                                    <div class="flex items-center mb-3">
                                        <div class="flex text-yellow-400 mr-2">
                                            <th:block th:each="i : ${#numbers.sequence(1, 5)}">
                                                <i th:class="${i <= tour.tour_rating} ? 'fas fa-star text-yellow-400' :
                                ((${(i > tour.tour_rating) and (i-1 < tour.tour_rating)}) ? 'fas fa-star-half-alt text-yellow-400' :
                                'far fa-star text-yellow-400')"></i>
                                            </th:block>
                                        </div>
                                        <span class="text-sm text-gray-600 font-medium"
                                              th:text="${#numbers.formatDecimal(tour.tour_rating, 1, 1)}"></span>
                                    </div>
                                    <!-- Location -->
                                    <div class="flex items-center text-gray-600 mb-2">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        <span th:text="${tour.tour_region == 'NORTH'} ? 'Miền Bắc' :
                                                  (${tour.tour_region == 'CENTRAL'} ? 'Miền Trung' :
                                                  (${tour.tour_region == 'SOUTHEAST'} ? 'Miền Đông Nam Bộ' : 'Miền Tây Nam Bộ'))"></span>
                                    </div>

                                    <!-- Departure Dates -->
                                    <div class="mb-4">
                                        <div class="flex items-center text-gray-600 mb-1">
                                            <i class="fas fa-calendar-day text-blue-500 mr-2"></i>
                                            <span class="font-medium">Ngày khởi hành: </span>
                                            <div class="flex flex-wrap gap-1.5">
                                                <!-- Hiển thị tối đa 3 ngày -->
                                                <span th:each="date,iter : ${RecommendedTourStartDates?.get(tour.tour_id)}"
                                                      th:if="${iter.index < 3 and date?.start_date != null}"
                                                      class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">
                <span th:text="${#temporals.format(date.start_date, 'dd/MM')}"></span>
            </span>

                                                <!-- Hiển thị số lượng ngày còn lại nếu có -->
                                                <span th:if="${RecommendedTourStartDates?.get(tour.tour_id)?.size() > 3}"
                                                      class="text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded-full">
                +<span th:text="${RecommendedTourStartDates.get(tour.tour_id).size() - 3}"></span> ngày khác
            </span>

                                                <!-- Trường hợp không có ngày khởi hành -->
                                                <span th:if="${RecommendedTourStartDates?.get(tour.tour_id) == null or RecommendedTourStartDates?.get(tour.tour_id)?.isEmpty()}"
                                                      class="text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded-full">
                Chưa có lịch khởi hành
            </span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Price & Details -->
                                    <div class="flex justify-between items-center pt-3 border-t border-gray-100 mt-auto">
                                        <div>
                                            <!-- Original price (crossed out) when discounted -->
                                            <div th:if="${tour.discount_promotion != null && #dates.createNow().after(tour.discount_promotion.ngayBatDau) && #dates.createNow().before(tour.discount_promotion.ngayKetThuc)}" class="text-sm text-gray-400 line-through mb-1">
                                                <span th:text="${#numbers.formatInteger(tour.tour_adult_price, 3, 'POINT') + '₫'}"></span>
                                            </div>
                                            <!-- Current price -->
                                            <div class="text-blue-700 font-bold text-lg">
                                                <span th:text="${#numbers.formatInteger(tour.discount_promotion != null && #dates.createNow().after(tour.discount_promotion.ngayBatDau) && #dates.createNow().before(tour.discount_promotion.ngayKetThuc) ? tour.tour_adult_price * (100 - tour.discount_promotion.phanTramGiamGia) / 100 : tour.tour_adult_price, 3, 'POINT') + '₫'}"></span>
                                                <span th:if="${tour.discount_promotion != null && #dates.createNow().after(tour.discount_promotion.ngayBatDau) && #dates.createNow().before(tour.discount_promotion.ngayKetThuc)}" class="text-sm text-red-600 ml-2">(Tiết kiệm <span th:text="${#numbers.formatInteger(tour.tour_adult_price * tour.discount_promotion.phanTramGiamGia / 100, 3, 'POINT') + '₫'}"></span>)</span>
                                            </div>
                                        </div>
                                        <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                                            <i class="fas fa-eye mr-1"></i> Xem ngay
                                        </button>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="swiper-button-next hidden md:flex"></div>
            <div class="swiper-button-prev hidden md:flex"></div>

            <!-- Pagination -->
            <div class="swiper-pagination mt-6"></div>
        </div>
    </div>
</section>

<!-- Featured Tours -->
<section class="py-12 bg-white">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3">TOUR NỔI BẬT</h2>
            <div class="w-20 h-1 bg-blue-600 mx-auto mb-4"></div>
            <p class="text-gray-600 max-w-2xl mx-auto text-lg">Khám phá những hành trình ấn tượng với ưu đãi đặc biệt</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" th:if="${tours != null}">
            <!-- Tour Card -->
            <div th:each="tour : ${tours}" class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 group"
                 th:attr="data-name=${tour.tour_name.toLowerCase()},
                          data-type=${tour.tour_type},
                          data-price=${tour.discount_promotion != null ? tour.tour_adult_price * (100 - tour.discount_promotion.phanTramGiamGia) / 100 : tour.tour_adult_price}">
                <a th:href="@{'/Client/TourDetail/' + ${tour.tour_id}}" class="block h-full flex flex-col">
                    <!-- Tour Image -->
                    <div class="relative h-56 overflow-hidden">
                        <img th:if="${tourThumbnails.get(tour.tour_id) != null and !tourThumbnails.get(tour.tour_id).isEmpty()}"
                             th:src="${tourThumbnails.get(tour.tour_id)}"
                             alt="Tour image"
                             class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                        <img th:unless="${tourThumbnails.get(tour.tour_id) != null and !tourThumbnails.get(tour.tour_id).isEmpty()}"
                             src="/img/default-tour.jpg"
                             alt="Default tour image"
                             class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">

                        <!-- Duration Badge -->
                        <div class="absolute top-4 left-4 bg-white/90 text-gray-800 px-3 py-1 rounded-full text-sm font-semibold shadow-sm">
                            <i class="fas fa-clock mr-1 text-blue-600"></i>
                            <span th:text="${tour.tour_duration} + ' ngày'"></span>
                        </div>

                        <!-- Discount Ribbon -->
                        <div th:if="${tour.discount_promotion != null && #dates.createNow().after(tour.discount_promotion.ngayBatDau) && #dates.createNow().before(tour.discount_promotion.ngayKetThuc)}"
                             class="absolute top-0 right-0 bg-red-600 text-white px-3 py-2 font-bold transform rotate-45 translate-x-8 -translate-y-2 w-32 text-center">
                            <span th:text="'Giảm ' + ${tour.discount_promotion.phanTramGiamGia} + '%'"></span>
                        </div>
                    </div>

                    <!-- Tour Info -->
                    <div class="p-5 flex-grow flex flex-col">
                        <!-- Tour Name -->
                        <h3 class="text-xl font-bold text-gray-800 mb-3 group-hover:text-blue-600 transition-colors" th:text="${tour.tour_name}"></h3>

                        <!-- Rating -->
                        <div class="flex items-center mb-3">
                            <div class="flex text-yellow-400 mr-2">
                                <th:block th:each="i : ${#numbers.sequence(1, 5)}">
                                    <i th:class="${i <= tour.tour_rating} ? 'fas fa-star text-yellow-400' :
                                ((${(i > tour.tour_rating) and (i-1 < tour.tour_rating)}) ? 'fas fa-star-half-alt text-yellow-400' :
                                'far fa-star text-yellow-400')"></i>
                                </th:block>
                            </div>
                            <span class="text-sm text-gray-600 font-medium"
                                  th:text="${#numbers.formatDecimal(tour.tour_rating, 1, 1)}"></span>
                        </div>
                        <!-- Location -->
                        <div class="flex items-center text-gray-600 mb-2">
                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                            <span th:text="${tour.tour_region == 'NORTH'} ? 'Miền Bắc' :
                                      (${tour.tour_region == 'CENTRAL'} ? 'Miền Trung' :
                                      (${tour.tour_region == 'SOUTHEAST'} ? 'Miền Đông Nam Bộ' : 'Miền Tây Nam Bộ'))"></span>
                        </div>

                        <!-- Departure Dates -->
                        <div class="mb-4">
                            <div class="flex items-center text-gray-600 mb-1">
                                <i class="fas fa-calendar-day text-blue-500 mr-2"></i>
                                <span class="font-medium">Ngày khởi hành: </span>
                                <div class="flex flex-wrap gap-1.5">
                                    <!-- Hiển thị tối đa 3 ngày -->
                                    <span th:each="date,iter : ${tourStartDates.get(tour.tour_id)}"
                                          th:if="${iter.index < 3}"
                                          class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">
                                    <span th:text="${#temporals.format(date.start_date, 'dd/MM')}"></span>
                                </span>
                                    <!-- Hiển thị số lượng ngày còn lại nếu có -->
                                    <span th:if="${tourStartDates.get(tour.tour_id).size() > 3}"
                                          class="text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded-full">
                                    +<span th:text="${tourStartDates.get(tour.tour_id).size() - 3}"></span> ngày khác
                                </span>
                                    <!-- Trường hợp không có ngày khởi hành -->
                                    <span th:if="${tourStartDates.get(tour.tour_id).isEmpty()}"
                                          class="text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded-full">
                                    Chưa có lịch khởi hành
                                </span>
                                </div>
                            </div>

                        </div>

                        <!-- Short Description -->
                        <p class="text-gray-600 mb-4 flex-grow" th:text="${tour.tour_description} ?: 'Khám phá hành trình đầy thú vị'"></p>

                        <!-- Price & Details -->
                        <div class="flex justify-between items-center pt-3 border-t border-gray-100">
                            <div>
                                <!-- Original price (crossed out) when discounted -->
                                <div th:if="${tour.discount_promotion != null && #dates.createNow().after(tour.discount_promotion.ngayBatDau) && #dates.createNow().before(tour.discount_promotion.ngayKetThuc)}" class="text-sm text-gray-400 line-through mb-1">
                                    <span th:text="${#numbers.formatInteger(tour.tour_adult_price, 3, 'POINT') + '₫'}"></span>
                                </div>
                                <!-- Current price -->
                                <div class="text-blue-700 font-bold text-lg">
                                    <span th:text="${#numbers.formatInteger(tour.discount_promotion != null && #dates.createNow().after(tour.discount_promotion.ngayBatDau) && #dates.createNow().before(tour.discount_promotion.ngayKetThuc) ? tour.tour_adult_price * (100 - tour.discount_promotion.phanTramGiamGia) / 100 : tour.tour_adult_price, 3, 'POINT') + '₫'}"></span>
                                    <span th:if="${tour.discount_promotion != null && #dates.createNow().after(tour.discount_promotion.ngayBatDau) && #dates.createNow().before(tour.discount_promotion.ngayKetThuc)}" class="text-sm text-red-600 ml-2">(Tiết kiệm <span th:text="${#numbers.formatInteger(tour.tour_adult_price * tour.discount_promotion.phanTramGiamGia / 100, 3, 'POINT') + '₫'}"></span>)</span>
                                </div>
                            </div>
                            <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                                <i class="fas fa-eye mr-1"></i> Xem ngay
                            </button>
                        </div>
                    </div>
                </a>
            </div>
        </div>

        <div class="text-center mt-10">
            <a href="/Client/SpecialOffers" class="inline-flex items-center justify-center bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white px-8 py-3 rounded-full font-medium text-lg shadow-lg hover:shadow-xl transition-all duration-300">
                <i class="fas fa-list mr-2"></i> Xem tất cả tour
            </a>
        </div>
    </div>
</section>

<!-- Popular Destinations -->
<section class="py-12 bg-gray-50">
    <div class="container mx-auto px-4">
        <div class="text-center mb-10">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-3">ĐIỂM ĐẾN YÊU THÍCH</h2>
            <p class="text-gray-600 max-w-2xl mx-auto">Khám phá các điểm đến du lịch nổi tiếng với chương trình tour độc quyền từ Vietravel</p>
        </div>

        <div class="flex overflow-x-auto pb-4 mb-6 hide-scrollbar">
            <div class="flex mx-auto space-x-4">
                <button class="destination-tab active whitespace-nowrap px-4 py-2" data-region="north">Miền Bắc</button>
                <button class="destination-tab whitespace-nowrap px-4 py-2" data-region="central">Miền Trung</button>
                <button class="destination-tab whitespace-nowrap px-4 py-2" data-region="southeast">Miền Đông Nam Bộ</button>
                <button class="destination-tab whitespace-nowrap px-4 py-2" data-region="southwest">Miền Tây Nam Bộ</button>
                <button class="destination-tab whitespace-nowrap px-4 py-2" data-region="asia">Châu Á</button>
                <button class="destination-tab whitespace-nowrap px-4 py-2" data-region="europe">Châu Âu</button>
                <button class="destination-tab whitespace-nowrap px-4 py-2" data-region="america">Châu Mỹ</button>
            </div>
        </div>
        <!-- Destination Grid - Miền Bắc -->
        <div th:replace="client_html/fragment/region/vietnam-region :: north-region"></div>
        <!-- Destination Grid - Miền Trung -->
        <div th:replace="client_html/fragment/region/vietnam-region :: central-region"></div>
        <!-- Destination Grid - Miền Đông Nam Bộ -->
        <div th:replace="client_html/fragment/region/vietnam-region :: southeast-region"></div>
        <!-- Destination Grid - Miền Tây Nam Bộ -->
        <div th:replace="client_html/fragment/region/vietnam-region :: southwest-region"></div>
        <!-- Destination Grid - Châu Á -->
        <div th:replace="client_html/fragment/region/other-region :: asia-region"></div>
        <!-- Destination Grid - Châu Âu -->
        <div th:replace="client_html/fragment/region/other-region :: europe-region"></div>
        <!-- Destination Grid - Châu Mỹ -->
        <div th:replace="client_html/fragment/region/other-region :: america-region"></div>
    </div>
</section>
<footer th:replace="client_html/fragment/headerANDfooter :: footer"></footer>
<script>

    // Tab functionality for destinations
    document.querySelectorAll('.destination-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            // Remove active class from all tabs
            document.querySelectorAll('.destination-tab').forEach(t => t.classList.remove('active'));

            // Add active class to clicked tab
            this.classList.add('active');

            // Hide all destination grids
            document.querySelectorAll('.destination-grid').forEach(grid => {
                grid.classList.add('hidden');
            });

            // Show the selected destination grid
            const region = this.getAttribute('data-region');
            document.getElementById(`${region}-region`).classList.remove('hidden');
        });
    });

    document.addEventListener('DOMContentLoaded', function() {
        const slides = document.querySelectorAll('.carousel-slide');
        const dots = document.querySelectorAll('.indicator-dot');
        const progressBars = document.querySelectorAll('.indicator-progress');
        let currentIndex = 0;
        let intervalId;
        const slideInterval = 5000; // 5 seconds

        function showSlide(index) {
            // Reset all slides and indicators
            slides.forEach(slide => slide.classList.remove('active', 'opacity-100'));
            slides.forEach(slide => slide.classList.add('opacity-0'));
            dots.forEach(dot => dot.classList.remove('active'));
            progressBars.forEach(bar => {
                bar.style.transform = 'scaleX(0)';
                bar.style.transitionDuration = '0ms';
            });

            // Show current slide
            slides[index].classList.add('active', 'opacity-100');
            dots[index].classList.add('active');
            progressBars[index].style.transitionDuration = slideInterval + 'ms';
            progressBars[index].style.transform = 'scaleX(1)';

            currentIndex = index;
        }

        function nextSlide() {
            const nextIndex = (currentIndex + 1) % slides.length;
            showSlide(nextIndex);
        }

        function startCarousel() {
            intervalId = setInterval(nextSlide, slideInterval);
        }

        function resetCarousel() {
            clearInterval(intervalId);
            startCarousel();
        }

        // Initialize
        if (slides.length > 1) {
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => {
                    showSlide(index);
                    resetCarousel();
                });
            });

            document.getElementById('nextBtn')?.addEventListener('click', () => {
                nextSlide();
                resetCarousel();
            });

            document.getElementById('prevBtn')?.addEventListener('click', () => {
                const prevIndex = (currentIndex - 1 + slides.length) % slides.length;
                showSlide(prevIndex);
                resetCarousel();
            });

            // Progress bar animation
            progressBars.forEach(bar => {
                bar.style.transformOrigin = 'left center';
            });

            startCarousel();
        }
    });
    document.addEventListener('DOMContentLoaded', function() {
        new Swiper('.recommended-tours-carousel', {
            slidesPerView: 1,
            spaceBetween: 20,
            loop: true,
            autoplay: {
                delay: 5000,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            breakpoints: {
                640: {
                    slidesPerView: 2,
                },
                1024: {
                    slidesPerView: 3,
                }
            }
        });

        new Swiper('.promotion-banners-carousel', {
            slidesPerView: 1,
            spaceBetween: 30,
            loop: true,
            centeredSlides: true,
            autoplay: {
                delay: 4000,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            breakpoints: {
                768: {
                    slidesPerView: 2,
                },
                1024: {
                    slidesPerView: 3,
                }
            }
        });
    });
</script>
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
</body>
</html>